<ion-content class="ion-padding">
  <div class="form-container">
    <div class="logo-container">
      <ion-img src="../../../../../assets//icono.png" class="logo"></ion-img>
    </div>

    <ion-card class="custom-card">
      <ion-card-header>
        <ion-card-title class="ion-text-center">Iniciar Sesión</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <form #loginForm="ngForm" (ngSubmit)="login()">
          <!-- Email -->
          <div class="input-container">
            <ion-label class="input-label">Correo Electrónico</ion-label>
            <ion-item class="form-input" lines="none"
              [class.input-invalid]="loginForm.submitted && loginForm.controls['email']?.invalid"
              [class.input-valid]="loginForm.submitted && loginForm.controls['email']?.valid">
              <ion-icon name="mail-outline" slot="start" class="input-icon"></ion-icon>
              <ion-input type="email" [(ngModel)]="credentials.email" name="email" required email
                placeholder="usuario@ejemplo.com" class="custom-input"></ion-input>
              <ion-icon slot="end" name="checkmark-circle" color="success" class="validation-icon"
                *ngIf="loginForm.submitted && loginForm.controls['email']?.valid"></ion-icon>
              <ion-icon slot="end" name="close-circle" color="danger" class="validation-icon"
                *ngIf="loginForm.submitted && loginForm.controls['email']?.invalid"></ion-icon>
            </ion-item>
            <ion-note color="danger" *ngIf="loginForm.submitted && loginForm.controls['email']?.invalid" class="error-message">
              Por favor, introduce un correo válido
            </ion-note>
          </div>

          <!-- Password -->
          <div class="input-container">
            <ion-label class="input-label">Contraseña</ion-label>
            <ion-item class="form-input" lines="none"
              [class.input-invalid]="loginForm.submitted && loginForm.controls['password']?.invalid"
              [class.input-valid]="loginForm.submitted && loginForm.controls['password']?.valid">
              <ion-icon name="lock-closed-outline" slot="start" class="input-icon"></ion-icon>
              <ion-input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="credentials.password" name="password"
                required placeholder="Mínimo 8 caracteres" class="custom-input"></ion-input>
              <ion-button fill="clear" slot="end" (click)="togglePasswordVisibility()" class="password-toggle">
                <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'" class="password-icon"></ion-icon>
              </ion-button>
            </ion-item>
            <ion-note color="danger" *ngIf="loginForm.submitted && loginForm.controls['password']?.invalid" class="error-message">
              La contraseña es requerida
            </ion-note>
          </div>

          <!-- Botón de login -->
          <ion-button expand="block" type="submit" class="login-button"
            [disabled]="isLoading">
            <div class="button-content">
              <ion-spinner *ngIf="isLoading" name="lines" class="spinner"></ion-spinner>
              <span *ngIf="!isLoading">Iniciar Sesión</span>
            </div>
          </ion-button>
        </form>

        <div class="register-container">
          <p>¿No tienes una cuenta?</p>
          <ion-button expand="block" fill="clear" routerLink="/auth/register" class="register-button">
            Regístrate
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
